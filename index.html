<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Landara — Club</title>
  <link rel="stylesheet" href="style.css" />
  <!--
    Hero images: use the images uploaded by the owner in assets/.
    Current uploaded files used:
    - assets/Casa-LIS.jpg
    - assets/Screenshot 2025-12-10 at 18.02.27.png
    - assets/Screenshot 2025-12-10 at 18.03.27.png
    - assets/Casa-Interior.jpg
    - assets/Pagodapalacio.jpg

    Note: file names contain spaces; the script uses encodeURI when loading them so renaming isn't strictly required.
  -->
  <style>
    /* Pequeñas utilidades para el nuevo UI de productos. Ajusta en style.css si lo prefieres */
    .product-controls { margin: 1rem 0; display:flex; gap:.5rem; flex-wrap:wrap; }
    #productForm { border:1px solid rgba(255,255,255,0.06); padding:1rem; background:rgba(0,0,0,0.04); border-radius:6px; max-width:720px; }
    #productForm input[type="text"], #productForm textarea { width:100%; padding:.5rem; margin:.25rem 0; border-radius:4px; border:1px solid #ccc; background:#fff; color:#000; }
    #productForm label { font-weight:600; display:block; margin-top:.5rem; }
    .product-list { display:flex; flex-direction:column; gap:1rem; margin-top:1rem; }
    .product-card { display:flex; gap:1rem; padding:1rem; border-radius:6px; background:#121212; color:#fff; align-items:flex-start; }
    .product-card img { width:160px; height:100px; object-fit:cover; border-radius:6px; }
    .product-card .card-body { flex:1; }
    .product-card .card-actions { display:flex; gap:.5rem; margin-top:.5rem; }
    .muted.small { margin-top:1rem; display:block; color: #9a9a9a; }
    .sr-only { position:absolute; left:-10000px; top:auto; width:1px; height:1px; overflow:hidden; }
    .btn { cursor:pointer; }
  </style>
</head>
<body>
  <a class="sr-only" href="#main">Saltar al contenido</a>

  <header class="site-header" role="banner">
    <div class="container header-inner">
      <div class="brand">
        <span class="brand-mark" aria-hidden="true">L</span>
        <span class="brand-name">Landara</span>
        <small class="brand-sub">Club</small>
      </div>

      <nav class="nav" role="navigation" aria-label="Main">
        <a href="#philosophy">Philosophy</a>
        <a href="#insights">Insights</a>
        <a href="#bi">One-Stop-Shop</a>
        <a href="#invitation">Invitation</a>
      </nav>

      <div class="header-actions">
        <button id="slideshowToggle" class="btn btn--small" aria-pressed="false">Pause Slideshow</button>
      </div>
    </div>
  </header>

  <header class="hero" role="region" aria-label="Hero">
    <!-- Optional local video -->
    <video id="heroVideo" class="hero__video" autoplay muted loop playsinline aria-hidden="true">
      <source src="assets/video.mp4" type="video/mp4" />
    </video>

    <div class="hero__slideshow" id="heroSlideshow" aria-hidden="true"></div>
    <div class="hero__overlay"></div>

    <div class="hero__content container">
      <h1 class="site-title">Landara — Club</h1>
      <p class="site-sub">Private Office</p>
      <div class="hero__actions">
        <a class="btn" href="#invitation">Access by invitation</a>
        <a class="btn btn--ghost" href="#bi">One-Stop-Shop</a>
      </div>
    </div>
  </header>

  <main id="main">
    <section id="philosophy" class="section philosophy" aria-labelledby="philosophy-title">
      <div class="container reveal">
        <h2 id="philosophy-title" class="section-title">Philosophy</h2>
        <p class="lead">
          Landara operates as an independent private office, advising on the strategic management of assets, structures, and personal interests across jurisdictions. We support informed decision-making and execution.
        </p>
      </div>
    </section>

    <section id="insights" class="section insights" aria-labelledby="services-title">
      <div class="container reveal">
        <h2 id="services-title" class="section-title">Insights</h2>

        <div class="services__grid">
          <article class="service card">
            <h3 class="service__title">Real Estate &amp; Private Investments</h3>
            <p class="service__desc">Sourcing, structuring and managing exclusive opportunities across global markets.</p>
            <a class="card-link" href="#bi">Insights</a>
          </article>

          <article class="service card">
            <h3 class="service__title">Art, Collectibles &amp; Classic Cars</h3>
            <p class="service__desc">Curatorial advisory, acquisition, conservation and discreet transactions.</p>
            <a class="card-link" href="#bi">Valuation data</a>
          </article>

          <article class="service card">
            <h3 class="service__title">Relocation, Education &amp; Lifestyle</h3>
            <p class="service__desc">Concierge services for relocation, private education placement and lifestyle management.</p>
            <a class="card-link" href="#invitation">Introduce</a>
          </article>

          <article class="service card">
            <h3 class="service__title">Global Legal &amp; Wealth Structuring</h3>
            <p class="service__desc">Cross‑border structuring, family governance and counsel coordinated with your advisors.</p>
            <a class="card-link" href="#bi">Documentation</a>
          </article>
        </div>
      </div>
    </section>

    <section id="bi" class="section bi" aria-labelledby="bi-title">
      <div class="container reveal">
        <h2 id="bi-title" class="section-title">One-Stop-Shop</h2>
        <p class="lead">Curated analytics and discreet reporting for your family office. Add charts, documents and notes below.</p>

        <div class="bi-panel">
          <aside class="bi-sidebar" role="navigation" aria-label="BI navigation">
            <button class="bi-tab is-active" data-target="overview">Overview</button>
            <button class="bi-tab" data-target="portfolio">Portfolio</button>
            <button class="bi-tab" data-target="art">Art & Collectibles</button>
            <button class="bi-tab" data-target="documents">Documents</button>
            <button class="bi-tab" data-target="products">Products</button>
          </aside>

          <div class="bi-content">
            <div id="overview" class="bi-pane is-active" role="region" aria-labelledby="bi-overview">
              <h3 id="bi-overview">Overview</h3>
              <p class="muted">Snapshot of high-level KPIs and recent activity.</p>
              <div class="kpis">
                <div class="kpi">
                  <div class="kpi-value">€1.9B</div>
                  <div class="kpi-label">AUM</div>
                </div>
                <div class="kpi">
                  <div class="kpi-value">6</div>
                  <div class="kpi-label">Active Projects</div>
                </div>
                <div class="kpi">
                  <div class="kpi-value">3</div>
                  <div class="kpi-label">Pending Transactions</div>
                </div>
              </div>
            </div>

            <div id="portfolio" class="bi-pane" role="region" aria-labelledby="bi-portfolio">
              <h3 id="bi-portfolio">Portfolio</h3>
              <p class="muted">Detailed holdings, performance charts and allocation.</p>
              <!-- Placeholder chart (SVG). Replace with your chart or embed an image here -->
              <div class="chart-placeholder" aria-hidden="true">
                <svg width="100%" height="180" viewBox="0 0 600 180" preserveAspectRatio="none" role="img" aria-label="placeholder chart">
                  <rect width="100%" height="100%" fill="#0f0f0f" />
                  <polyline points="0,150 60,120 120,100 180,90 240,110 300,70 360,80 420,50 480,60 540,40 600,30" stroke="#fff" stroke-opacity="0.8" stroke-width="3" fill="none"/>
                </svg>
              </div>
            </div>

            <div id="art" class="bi-pane" role="region" aria-labelledby="bi-art">
              <h3 id="bi-art">Art & Collectibles</h3>
              <p class="muted">Inventory records, provenance notes and valuation history.</p>
              <ul class="inventory">
                <li><strong>Lot 001:</strong> Private collection — Classic car (1956)</li>
                <li><strong>Lot 002:</strong> Painting — provenance available on request</li>
              </ul>
            </div>

            <div id="documents" class="bi-pane" role="region" aria-labelledby="bi-docs">
              <h3 id="bi-docs">Documents</h3>
              <p class="muted">Secure documents can be listed here (link to secure channels).</p>
              <div class="doc-list">
                <a class="doc" href="#" aria-disabled="true">Family Governance — Overview (placeholder)</a>
                <a class="doc" href="#" aria-disabled="true">Investment Memo — Private Opportunity</a>
              </div>
            </div>

            <!-- Products pane -->
            <div id="products" class="bi-pane" role="region" aria-labelledby="bi-products">
              <h3 id="bi-products">Products</h3>
              <p class="muted">Publicar productos como si fueran artículos de blog. Guardado local (localStorage).</p>

              <div class="product-controls">
                <button id="addProductBtn" class="btn">Add product</button>
                <small class="muted">Los artículos se guardan en el navegador. Para compartirlos o mantenerlos persistentes entre dispositivos, conecta un backend.</small>
              </div>

              <form id="productForm" style="display:none;" aria-hidden="true">
                <input type="hidden" id="productId" value="">
                <label for="productTitle">Título</label>
                <input id="productTitle" type="text" placeholder="Título del producto" required>

                <label for="productExcerpt">Extracto</label>
                <textarea id="productExcerpt" rows="2" placeholder="Extracto corto"></textarea>

                <label for="productContent">Contenido</label>
                <textarea id="productContent" rows="6" placeholder="Contenido detallado (puedes pegar HTML simple si lo deseas)"></textarea>

                <label for="productImage">Imagen (opcional, máximo 5 MB)</label>
                <input id="productImage" type="file" accept="image/*">
                <div id="imagePreview" aria-hidden="true" style="margin-top:.5rem;"></div>

                <div style="margin-top:.5rem;">
                  <button id="saveProductBtn" type="button" class="btn">Guardar</button>
                  <button id="cancelProductBtn" type="button" class="btn btn--ghost">Cancelar</button>
                  <span id="productFormMsg" style="margin-left:1rem;color:#f66;"></span>
                </div>
              </form>

              <div id="productList" class="product-list" aria-live="polite"></div>

              <p class="muted small">Uso local: si borras los datos del navegador se perderán los artículos. Para integración con servidor, puedo ayudarte a adaptar el formulario al endpoint que tengas.</p>
            </div>

          </div>
        </div>

        <p class="muted small">This One-Stop-Shop area is a placeholder — replace with your internal dashboards or embeds (charts, PDFs, links).</p>
      </div>
    </section>

    <section id="invitation" class="section invitation" aria-labelledby="invitation-title">
      <div class="container reveal">
        <h2 id="invitation-title" class="section-title">Access by invitation only</h2>
        <p class="lead">We operate by invitation to ensure privacy and an elevated client experience. For inquiries, please contact an introducer or reach out through a trusted referral.</p>
        <p class="muted">No login or user database is maintained on this site.</p>
      </div>
    </section>
  </main>

  <footer class="site-footer" role="contentinfo">
    <div class="container footer__inner">
      <div>
        <small>&copy; <span id="year"></span> Landara — Club. All rights reserved.</small>
        <div class="hero-credits">
          <small>Hero images: uploaded by owner</small>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // 2025
    document.getElementById('year').textContent = new Date().getFullYear();

    // slides: use the uploaded filenames (spaces handled via encodeURI when creating URLs)
    const slides = [
      'assets/Screenshot 2025-12-10 at 18.02.27.png',
      'assets/Screenshot 2025-12-10 at 18.03.27.png'
    ];

    const slideshowContainer = document.getElementById('heroSlideshow');
    let slideEls = [];
    let slideshowInterval = null;
    let current = 0;
    const delay = 6000;

    function createSlides() {
      slides.forEach((src, idx) => {
        const s = document.createElement('div');
        s.className = 'slide';

        const img = new Image();
        img.src = encodeURI(src);
        img.onload = () => {
          const ratio = img.naturalWidth / img.naturalHeight;
          let focusY = '50%';
          if (ratio > 1.8) focusY = '35%';
          else if (ratio > 1.3) focusY = '42%';
          s.style.backgroundImage = `url(\"${encodeURI(src)}\")`;
          s.style.backgroundPosition = `center ${focusY}`;
        };
        img.onerror = () => {
          s.style.backgroundImage = `url(\"${encodeURI(src)}\")`;
          s.style.backgroundPosition = 'center 50%';
        };

        if (idx === 0) s.classList.add('is-active');
        slideshowContainer.appendChild(s);
      });

      slideEls = slideshowContainer.querySelectorAll('.slide');
    }

    function startSlideshow() {
      if (slideshowInterval) return;
      if (slideEls.length <= 1) return;
      slideshowInterval = setInterval(() => {
        slideEls[current].classList.remove('is-active');
        current = (current + 1) % slideEls.length;
        slideEls[current].classList.add('is-active');
      }, delay);
      document.getElementById('slideshowToggle').textContent = 'Pause Slideshow';
      document.getElementById('slideshowToggle').setAttribute('aria-pressed','false');
    }

    function stopSlideshow() {
      clearInterval(slideshowInterval);
      slideshowInterval = null;
      document.getElementById('slideshowToggle').textContent = 'Resume Slideshow';
      document.getElementById('slideshowToggle').setAttribute('aria-pressed','true');
    }

    document.getElementById('slideshowToggle').addEventListener('click', () => {
      if (slideshowInterval) stopSlideshow(); else startSlideshow();
    });

    // Reveal on scroll
    function revealOnScroll() {
      const reveals = document.querySelectorAll('.reveal');
      reveals.forEach(el => {
        const rect = el.getBoundingClientRect();
        if (rect.top < window.innerHeight - 80) el.classList.add('is-visible');
      });
    }
    window.addEventListener('scroll', revealOnScroll, {passive: true});

    // BI tabs
    document.querySelectorAll('.bi-tab').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.bi-tab').forEach(b => b.classList.remove('is-active'));
        btn.classList.add('is-active');
        const target = btn.dataset.target;
        document.querySelectorAll('.bi-pane').forEach(p => p.classList.remove('is-active'));
        const pane = document.getElementById(target);
        if (pane) pane.classList.add('is-active');
      });
    });

    // Init slideshow and reveal
    createSlides();
    setTimeout(() => { slideEls = slideshowContainer.querySelectorAll('.slide'); startSlideshow(); }, 140);
    revealOnScroll();

    /* --------------------------
       Products (client-side CRUD)
       -------------------------- */
    const STORAGE_KEY = 'landara_products';
    const maxImageSize = 5 * 1024 * 1024; // 5 MB

    const addProductBtn = document.getElementById('addProductBtn');
    const productForm = document.getElementById('productForm');
    const productIdEl = document.getElementById('productId');
    const titleEl = document.getElementById('productTitle');
    const excerptEl = document.getElementById('productExcerpt');
    const contentEl = document.getElementById('productContent');
    const imageInput = document.getElementById('productImage');
    const imagePreview = document.getElementById('imagePreview');
    const saveProductBtn = document.getElementById('saveProductBtn');
    const cancelProductBtn = document.getElementById('cancelProductBtn');
    const productFormMsg = document.getElementById('productFormMsg');
    const productList = document.getElementById('productList');

    let imageDataUrl = null; // base64 data url for preview/storage

    function getProducts() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch (e) {
        console.error('Error reading products', e);
        return [];
      }
    }

    function saveProducts(arr) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
      renderProducts();
    }

    function renderProducts() {
      const items = getProducts();
      productList.innerHTML = '';
      if (!items.length) {
        productList.innerHTML = '<div class="muted">No hay productos aún. Pulsa "Add product" para crear uno.</div>';
        return;
      }
      items.slice().reverse().forEach(item => {
        const card = document.createElement('article');
        card.className = 'product-card card';
        const imgWrapper = document.createElement('div');
        if (item.image) {
          const img = document.createElement('img');
          img.src = item.image;
          img.alt = item.title || 'Imagen del producto';
          imgWrapper.appendChild(img);
        } else {
          const placeholder = document.createElement('div');
          placeholder.style.width = '160px';
          placeholder.style.height = '100px';
          placeholder.style.background = 'rgba(255,255,255,0.04)';
          placeholder.style.borderRadius = '6px';
          imgWrapper.appendChild(placeholder);
        }

        const body = document.createElement('div');
        body.className = 'card-body';
        const h4 = document.createElement('h4');
        h4.textContent = item.title;
        const ex = document.createElement('p');
        ex.textContent = item.excerpt || '';
        ex.className = 'muted';
        const contentDiv = document.createElement('div');
        contentDiv.innerHTML = item.content ? item.content : '';
        contentDiv.style.marginTop = '.5rem';

        const actions = document.createElement('div');
        actions.className = 'card-actions';
        const editBtn = document.createElement('button');
        editBtn.className = 'btn';
        editBtn.textContent = 'Edit';
        editBtn.addEventListener('click', () => editProduct(item.id));
        const delBtn = document.createElement('button');
        delBtn.className = 'btn btn--ghost';
        delBtn.textContent = 'Delete';
        delBtn.addEventListener('click', () => deleteProduct(item.id));

        actions.appendChild(editBtn);
        actions.appendChild(delBtn);

        body.appendChild(h4);
        body.appendChild(ex);
        body.appendChild(contentDiv);
        body.appendChild(actions);

        card.appendChild(imgWrapper);
        card.appendChild(body);
        productList.appendChild(card);
      });
    }

    function resetForm() {
      productIdEl.value = '';
      titleEl.value = '';
      excerptEl.value = '';
      contentEl.value = '';
      imageInput.value = '';
      imageDataUrl = null;
      imagePreview.innerHTML = '';
      productFormMsg.textContent = '';
    }

    function openForm(editing=false) {
      productForm.style.display = '';
      productForm.setAttribute('aria-hidden','false');
      titleEl.focus();
      if (!editing) resetForm();
    }

    function closeForm() {
      productForm.style.display = 'none';
      productForm.setAttribute('aria-hidden','true');
      resetForm();
    }

    addProductBtn.addEventListener('click', () => openForm(false));
    cancelProductBtn.addEventListener('click', () => closeForm());

    imageInput.addEventListener('change', (e) => {
      const f = e.target.files && e.target.files[0];
      if (!f) {
        imageDataUrl = null;
        imagePreview.innerHTML = '';
        return;
      }
      if (f.size > maxImageSize) {
        productFormMsg.textContent = 'Imagen demasiado grande (máx 5 MB).';
        imageInput.value = '';
        imageDataUrl = null;
        imagePreview.innerHTML = '';
        return;
      }
      const reader = new FileReader();
      reader.onload = () => {
        imageDataUrl = reader.result;
        imagePreview.innerHTML = `<img src="${imageDataUrl}" alt="Previsualización" style="max-width:220px;max-height:140px;border-radius:6px;">`;
      };
      reader.readAsDataURL(f);
    });

    saveProductBtn.addEventListener('click', () => {
      const title = titleEl.value && titleEl.value.trim();
      const excerpt = excerptEl.value && excerptEl.value.trim();
      const content = contentEl.value && contentEl.value.trim();
      if (!title) {
        productFormMsg.textContent = 'El título es obligatorio.';
        titleEl.focus();
        return;
      }
      productFormMsg.textContent = '';

      const products = getProducts();
      const editingId = productIdEl.value;
      if (editingId) {
        // update
        const idx = products.findIndex(p => String(p.id) === String(editingId));
        if (idx > -1) {
          products[idx].title = title;
          products[idx].excerpt = excerpt;
          products[idx].content = content;
          if (imageDataUrl) products[idx].image = imageDataUrl;
          saveProducts(products);
        }
      } else {
        const newItem = {
          id: Date.now(),
          title,
          excerpt,
          content,
          image: imageDataUrl || null,
          created_at: new Date().toISOString()
        };
        products.push(newItem);
        saveProducts(products);
      }
      closeForm();
    });

    function editProduct(id) {
      const products = getProducts();
      const item = products.find(p => String(p.id) === String(id));
      if (!item) return;
      productIdEl.value = item.id;
      titleEl.value = item.title || '';
      excerptEl.value = item.excerpt || '';
      contentEl.value = item.content || '';
      if (item.image) {
        imageDataUrl = item.image;
        imagePreview.innerHTML = `<img src="${imageDataUrl}" alt="Previsualización" style="max-width:220px;max-height:140px;border-radius:6px;">`;
      } else {
        imageDataUrl = null;
        imagePreview.innerHTML = '';
      }
      openForm(true);
      window.scrollTo({ top: productForm.getBoundingClientRect().top + window.scrollY - 80, behavior: 'smooth' });
    }

    function deleteProduct(id) {
      if (!confirm('Eliminar este producto? Esta acción no se puede deshacer.')) return;
      let products = getProducts();
      products = products.filter(p => String(p.id) !== String(id));
      saveProducts(products);
    }

    // Inicializar lista
    renderProducts();

    // Observaciones:
    // - Este almacenamiento es local al navegador. Para sincronizar entre usuarios/servidores necesitamos un endpoint (puedo ayudarte).
    // - Si quieres limitar HTML permitido en content, conviene sanitizar antes de insertar (aquí usamos innerHTML tal cual para flexibilidad).
  </script>
</body>
</html>
